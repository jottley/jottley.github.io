<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Alfresco: Permissions Web Scripts &#8211; I exist as I am</title>
<meta name="description" content="">
<meta name="keywords" content="Alfresco, AMP, web script">
<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/">
<meta name="twitter:title" content="Alfresco: Permissions Web Scripts">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@jottley">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Alfresco: Permissions Web Scripts">
<meta property="og:description" content="">
<meta property="og:url" content="http://localhost:4000/alfresco/alfresco-permissions-web-scripts">
<meta property="og:site_name" content="I exist as I am">





<link rel="canonical" href="http://localhost:4000/alfresco/alfresco-permissions-web-scripts">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="I exist as I am Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<!--[if (lt IE 9) & (!IEMobile)]>
<link rel="stylesheet" href="http://localhost:4000/assets/css/ie.min.css">
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->

<script src="http://localhost:4000/assets/js/modernizr.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="article" itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div id="outer-wrap">
<div id="inner-wrap">

    <header id="top" role="banner">
        <div class="block">
            <h1 class="block-title">I exist as I am</h1>
            <a class="nav-btn" id="nav-open-btn" href="#nav">Navigation</a>
        </div>
    </header>

    <nav id="nav" role="navigation">
        <div class="block">
            <h2 class="block-title">Chapters</h2>
            <ul>
                
				<li><a href="http://localhost:4000/" >Home</a></li>
		        
				<li><a href="http://localhost:4000/about/" >About</a></li>
		        
				<li><a href="http://localhost:4000/articles/" >Articles</a></li>
		        
		        <li><a href="http://localhost:4000/feed.xml" title="Atom/RSS feed">Feed</a>
            </ul>
            <a class="close-btn" id="nav-close-btn" href="#top">Return to Content</a>
        </div>
    </nav>



<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <div class="article-author-side">
    <img src="http://localhost:4000/images/photo.JPG" class="bio-photo" alt="Jared Ottley bio photo"></a>
<h3>Jared Ottley</h3>
<p>Jared Ottley is a Tech Lead Engineer and Salesforce SME at <a href='http://www.alfresco.com'>Alfresco</a>.  To wind down he coaches lacrosse Springville High School. As the father of 6 he is raising a geek army. He has a degree in Political Science and drives a Mini.</p>
<a href="mailto:jared@ottleys.net" class="author-social"><i class="icon-mail"></i> jared@ottleys.net</a>
<a href="http://twitter.com/jottley" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>
<a href="http://facebook.com/jottley" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>

<a href="http://linkedin.com/in/jottley" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>
<a href="http://instagram.com/jaredrottley" class="author-social" target="_blank"><i class="icon-instagram"></i> Instagram</a>
<a href="http://github.com/jottley" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>
<a href="http://lastfm.com/user/jottley" class="author-social" target="_blank"><i class="icon-lastfm"></i> Last.fm</a>
<a href="http://www.flickr.com/photos/jottley" class="author-social" target="_blank"><i class="icon-flickr"></i> Flickr</a>

  </div>
  <article itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="headline-wrap">
      <h1 itemprop="name">Alfresco: Permissions Web Scripts</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap" itemprop="text">
      <p>A couple of months back I was asked to write a couple of web scripts to help one of our customers to be able to check and modify permissions for content/spaces in the Alfresco repository.  I’ve finally had the chance to spend sometime testing and now writing about them.</p>

<p>The core of the web scripts was quick to write.  The fun (more time consuming) part was working with exception handling in javascipt.  I know tons of fun right!  There are few different ways to use exception handling based on which version of Alfresco you are using.  The customer is on Enterprise 3.1 and I wanted to make sure that the web scripts also worked on the more current releases of Alfresco as well.  A <a href="https://issues.alfresco.com/jira/browse/ALF-1958">change (re: addition)</a> was made in Enterprise 3.2.1 and Community 3.3 to help simplify exception handeling.  I’ll talk about exception handling and these differences in a follow up post.  For now let’s talk about these new web scripts.</p>

<h2 id="permissions-get"><strong>permissions GET</strong></h2>

<p>The first web script returns all of the permissions for a specified node.</p>

<p>The URL used is <code class="language-plaintext highlighter-rouge">/alfresco/service/permissions/{store_type}/{store_id}/{id}</code></p>

<p>Where</p>

<p style="padding-left: 30px">
  <code>store_type</code>: The type of store you want to query, ex: <code>workspace</code>
</p>

<p style="padding-left: 30px">
  <code>store_id</code>: The ID of the store you want to query, ex: <code>SpacesStore</code>
</p>

<p style="padding-left: 30px">
  <code>id</code>: The UUID of the node, ex: <code>aed218e8-df44-4865-84cd-0105252f4993</code>
</p>

<p>The above values are joined together to form the nodeRef.</p>

<p>If the node is not found a 404 error will be returned, any missing URI parameters will result in a 400 error and if you don’t have permission to view the node you will get a 401 error.</p>

<p>The web script will return a JSON object that looks like the following:</p>

<pre class="brush: jscript; title: ; notranslate" title="">{ "permissions": [
"ALLOWED;user1;Coordinator",
"ALLOWED;user2;Coordinator"
] ,
"inherit": false }</pre>

<p>The return object lists the permissions in a triplet for that node. The permissions triplet follow this format:</p>

<p style="padding-left: 30px">
  <code>[ALLOWED|DENIED];[USERNAME|GROUPNAME];PERMISSION</code>
</p>

<p>It also returns a boolean value indicating if some permissions are inherited from the parent node.</p>

<p>The above example shows two permissions are assigned to the node: the Coordinator permission is given to user1 and user2 on this node. Permissions are not inherited from the parent node.</p>

<h2 id="permissions-post"><strong>permissions POST</strong></h2>

<p>This web script enables you to modify the permissions for a given node</p>

<p>It is called through the same URL as the above web script but as a POST instead of a get: <code class="language-plaintext highlighter-rouge">/alfresco/service/permissions/{store_type}/{store_id}/{id}</code></p>

<p>Again, if the node is not found a 404 error will be returned, any missing URI parameters will result in a 400 error and if you don’t have permission to modify the node, you will get a 401 error.</p>

<p>You must also pass a JSON object containing the permissions that are being changed, deleted or added.</p>

<pre class="brush: jscript; title: ; notranslate" title="">{ permissions: [
"REMOVE;user3;All",
"REMOVE;user2;All",
"ADD;user4;Coordinator",
"ADD;GROUP_usergroup1;Consumer"
] ,
"inherit": false }
</pre>

<p>The above example uses the following triplet to define a permission</p>

<p style="padding-left: 30px">
  <code>[ADD|REMOVE];[USERNAME|GROUPNAME];PERMISSION</code>
</p>

<p>Where the values are defined as:</p>

<p style="padding-left: 30px">
  <code>ADD | REMOVE</code>: Do you want to add or remove the permission for this user/group? Any other value passed will result in a 400 error.
</p>

<p style="padding-left: 30px">
  <code>USERNAME | GROUPNAME</code>: The user or group you want the permission to be added or removed for. Group names must be prefixed by GROUP_. Unknown users or groups will result in a 400 error.
</p>

<p style="padding-left: 30px">
  <code>PERMISSION</code>: The supported permissions options are defined in<br /> <code>org.alfresco.service.cmr.security.PermissionService</code> or through custom extension to the permission model. Unknown permissions will result in a 400 error.
</p>

<p>The object can also contain an optional inherit permission value to specifying if the permissions for this node should be inherited from the parent node. Without the inherit option, the current value for the node is maintained. Inherited permissions can not be removed from a node.</p>

<p>The return format is the same as the return format of the permissions GET web script above.</p>

<p>This web script is also transactional: any errors will result in the node being returned to the state before the call was made. (The exception handling in the controller was added for these conditions.)</p>

<p>These scripts can be installed as an AMP.  The <a href="http://code.google.com/p/alfresco-permissions-webscripts/source/checkout">code</a> and <a href="http://code.google.com/p/alfresco-permissions-webscripts/downloads/list">AMPs</a> are hosted in the <a href="http://code.google.com/p/alfresco-permissions-webscripts/">alfresco-permissions-webscripts</a> project on Google Code.  The code is available for either <a href="http://code.google.com/p/alfresco-permissions-webscripts/downloads/detail?name=alfresco-permissions-webscripts-pre.3.2.1.amp">pre-3.2.1 (starting with 3.1)</a> or <a href="http://code.google.com/p/alfresco-permissions-webscripts/downloads/detail?name=alfresco-permissions-webscripts.amp">3.2.1 to 3.3.1</a>.  These are all Enterprise releases numbers.  The web scripts have been tested against these releases.  There may not be any need to modify the web scripts for Community releases (except for the min and max version numbers in the module.properties file).  Pre community 3.3 should use the pre 3.2.1 release.  No community releases have been tested. (If you try these on a community releases, please comment either here or in the Google Code Project.)</p>

<p>In a follow up post, I’ll cover exception handling with JavaScript.</p>


      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="http://localhost:4000/images/photo.JPG" class="bio-photo" alt="Jared Ottley bio photo"></a>
<h3>Jared Ottley</h3>
<p>Jared Ottley is a Tech Lead Engineer and Salesforce SME at <a href='http://www.alfresco.com'>Alfresco</a>.  To wind down he coaches lacrosse Springville High School. As the father of 6 he is raising a geek army. He has a degree in Political Science and drives a Mini.</p>
<a href="mailto:jared@ottleys.net" class="author-social"><i class="icon-mail"></i> jared@ottleys.net</a>
<a href="http://twitter.com/jottley" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>
<a href="http://facebook.com/jottley" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>

<a href="http://linkedin.com/in/jottley" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>
<a href="http://instagram.com/jaredrottley" class="author-social" target="_blank"><i class="icon-instagram"></i> Instagram</a>
<a href="http://github.com/jottley" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>
<a href="http://lastfm.com/user/jottley" class="author-social" target="_blank"><i class="icon-lastfm"></i> Last.fm</a>
<a href="http://www.flickr.com/photos/jottley" class="author-social" target="_blank"><i class="icon-flickr"></i> Flickr</a>

        </div>
        <p class="byline"><strong>Alfresco: Permissions Web Scripts</strong> was published on <time datetime="2010-08-26T00:00:00-06:00" itemprop="datePublished">August 26, 2010</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="http://localhost:4000/about" title="About Jared Ottley" itemprop="url">Jared Ottley</a></span></span>.</p>
      </footer>
      

      
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/articles">View all articles</a>)</small></h4>
    <ul>
    
      
      
      
      <li><a href="http://localhost:4000/alfresco/alfresco-cmis-browser-binding-delete" title="Alfresco&#58; CMIS Browser Binding DELETE example">Alfresco&#58; CMIS Browser Binding DELETE example</a></li>
      
    
      
      
      
      <li><a href="http://localhost:4000/alfresco/alfresco-property-decorators-cont" title="Alfresco: Property Decorators &#8212; cont.">Alfresco: Property Decorators &#8212; cont.</a></li>
      
    
      
      
      
      <li><a href="http://localhost:4000/alfresco/alfresco-simple-workflow-web-scripts" title="Alfresco: Simple Workflow Web Scripts">Alfresco: Simple Workflow Web Scripts</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2020 Jared Ottley. The thoughts here are my own and are not my employers...so blame me.</span>
  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>
<script src="http://localhost:4000/assets/js/main.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-73397-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
	        

</body>
</html>
