<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Lessons learned in Appliance building, Ideas for the Future &#8211; I exist as I am</title>
<meta name="description" content="">
<meta name="keywords" content="Alfresco, appliance">
<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jared.ottleys.net/images/">
<meta name="twitter:title" content="Lessons learned in Appliance building, Ideas for the Future">
<meta name="twitter:description" content="Something Something Something">
<meta name="twitter:creator" content="@jottley">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Lessons learned in Appliance building, Ideas for the Future">
<meta property="og:description" content="Something Something Something">
<meta property="og:url" content="http://jared.ottleys.net/alfresco/lessons-learned-in-appliance-building-ideas-for-the-future">
<meta property="og:site_name" content="I exist as I am">





<link rel="canonical" href="http://jared.ottleys.net/alfresco/lessons-learned-in-appliance-building-ideas-for-the-future">
<link href="http://jared.ottleys.net/feed.xml" type="application/atom+xml" rel="alternate" title="I exist as I am Feed">
<link rel="author" href="https://plus.google.com/u/0/116380333940951424604/posts?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://jared.ottleys.net/assets/css/main.min.css">

<!--[if (lt IE 9) & (!IEMobile)]>
<link rel="stylesheet" href="http://jared.ottleys.net/assets/css/ie.min.css">
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->

<script src="http://jared.ottleys.net/assets/js/modernizr.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://jared.ottleys.net/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://jared.ottleys.net/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://jared.ottleys.net/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://jared.ottleys.net/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://jared.ottleys.net/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://jared.ottleys.net/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="article" itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div id="outer-wrap">
<div id="inner-wrap">

    <header id="top" role="banner">
        <div class="block">
            <h1 class="block-title">I exist as I am</h1>
            <a class="nav-btn" id="nav-open-btn" href="#nav">Navigation</a>
        </div>
    </header>

    <nav id="nav" role="navigation">
        <div class="block">
            <h2 class="block-title">Chapters</h2>
            <ul>
                
				<li><a href="http://jared.ottleys.net/" >Home</a></li>
		        
				<li><a href="http://jared.ottleys.net/about/" >About</a></li>
		        
				<li><a href="http://jared.ottleys.net/articles/" >Articles</a></li>
		        
		        <li><a href="http://jared.ottleys.net/feed.xml" title="Atom/RSS feed">Feed</a>
            </ul>
            <a class="close-btn" id="nav-close-btn" href="#top">Return to Content</a>
        </div>
    </nav>



<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <div class="article-author-side">
    <img src="http://jared.ottleys.net/images/photo.JPG" class="bio-photo" alt="Jared Ottley bio photo"></a>
<h3>Jared Ottley</h3>
<p>Jared Ottley is an engineer at <a href='http://www.alfresco.com'>Alfresco</a>.  As the father of 6 he is raising a geek army. He has a degree in Political Science and drives a Mini.</p>
<a href="mailto:jared@ottleys.net" class="author-social"><i class="icon-mail"></i> jared@ottleys.net</a>
<a href="http://twitter.com/jottley" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>
<a href="http://facebook.com/jottley" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>
<a href="https://plus.google.com/u/0/116380333940951424604/posts" class="author-social" target="_blank"><i class="icon-google-plus"></i> Google+</a>
<a href="http://linkedin.com/in/jottley" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>
<a href="http://instagram.com/jaredtottley" class="author-social" target="_blank"><i class="icon-instagram"></i> Instagram</a>
<a href="http://github.com/jottley" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>
<a href="http://lastfm.com/jottley" class="author-social" target="_blank"><i class="icon-lastfm"></i> Last.fm</a>
<a href="http://www.flickr.com/photos/jottley" class="author-social" target="_blank"><i class="icon-flickr"></i> Flickr</a>

  </div>
  <article itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="headline-wrap">
      <h1 itemprop="name">Lessons learned in Appliance building, Ideas for the Future</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap" itemprop="text">
      <p>Errands run, kids in bed, and <a href="http://www.imdb.com/title/tt0085811/" target="_blank">Krull</a> <a href="http://en.wikipedia.org/wiki/Video_on_demand" target="_blank">On Demand</a>. Finally, sometime to put some thoughts down about building the <a href="http://jared.ottleys.net/alfresco/alfresco-appliance-212" target="_blank">Alfresco Appliance</a>.</p>

<p>Some of what I write here <a href="http://jared.ottleys.net/alfresco/evaluating-with-a-virtual-appliance" target="_blank">refers back</a> to when I original put together, the first version of the appliance. Some is from revisiting it for <a href="http://jared.ottleys.net/alfresco/alfresco-appliance-212" target="_blank">this release</a>.</p>

<p><strong>Choosing a distribution</strong></p>

<p>I started playing with building an appliance right about the time that Ubuntu announced their <a href="http://www.ubuntu.com/products/whatisubuntu/serveredition/jeos" target="_blank">Jeos distribution</a>. I have a strong preference for <a href="http://www.opensuse.org/" target="_blank">openSUSE</a> and would have liked to have built the appliance on it. (<a href="http://en.opensuse.org/LimeJeos" target="_blank">LimeJEOS</a> answers my concerns, and I am excited to give it a spin. Just a few more things to move off my plate before I can devote time to it.) I tried several different distributions: <a href="http://fedoraproject.org/" target="_blank">Fedora</a>, <a href="http://www.opensuse.org/" target="_blank">openSUSE</a>, <a href="http://www.ubuntu.com" target="_blank">Ubuntu</a>, <a href="http://www.puppylinux.org/" target="_blank">Puppy Linux</a>, <a href="http://www.zenwalk.org/" target="_blank">Zen Walk</a>. I liked some, was optimistic about others, and disappointed and frustrated with a couple.</p>

<p>What I wanted was a distribution that provided me a small lightweight base, and gives me the ability to add just the packages I needed to run my application. Most of these came in close to what I wanted, but due to dependencies, grew to be much larger than I wanted. Some didn’t even provide me with a nice clean way to get the applications I was dependent on. Those I dropped immediately. Those with decent package mangers got pluses. I wanted to be to keep base packages up to date.</p>

<p>This brings us to Ubuntu Jeos (<a href="http://en.wikipedia.org/wiki/Jeos" target="_blank">Just Enough OS</a>). It gave me the size, the packages, and the manager that met my base criteria for a distribution.</p>

<p><strong>Getting Started</strong></p>

<p>While the base install is already fairly small, there still are many packages that I was going to need and not need. This takes some time, but go through the installed packages and identify what you aren’t and are going to need. Make a list and develop a script to remove the ones you don’t need. Another to add the ones you need. You may like to have some of the packages around while developing your appliance, but when you go to deliver it they may add more weight than what you would like, or give tools that just aren’t need by your appliance, or your end users. Keep them installed until you are sure they aren’t needed any more. My list includes: man pages, wireless-tools, sound packages, laptop packages, different editors, hardware utilities, etc. Your list will vary. Sometimes you may want to force remove dependent packages if you know their functionality is not needed. Don’t be afraid to take them out.</p>

<p>I know my list is not perfect, but over time it will improve. Some of this will come with trial and error. Don’t expect to get it right the first time.</p>

<p>Once I narrowed the package list, I started to add my dependent packages. Some of these could require you to re-add removed packages. That is why I suggest leaving packages installed until you have all your dependencies installed.</p>

<p>One of the cornerstones of an appliance is zero configuration. You want people to be able to just deploy the appliance, start it and use the appliance. In the case of <a href="http://www.alfresco.com" target="_blank">Alfresco</a>, it needs <a href="http://tomcat.apache.org/" target="_blank">Tomcat</a> to be started at boot time. For this I needed an <a href="http://en.wikipedia.org/wiki/Linux_startup_process#Init_process_.28SysV_init_style_only.29" target="_blank">init script</a>. (Mine can be found <a href="http://svn.ottleys.net/public/alfresco/init/ubuntu/alfresco" target="_blank">here</a>.) I use the init script to start Tomcat, start needed services, and perform runtime configurations.</p>

<p>Alfresco is a web-based application, so I need a way to provide the URL needed by users to access the application. For an appliance this can be changed from install to install. There are several ways to handle this, eventual, you will want to have a static address or use Dynamic DNS to update IP to name mappings. My appliances is primarily for evaluation. It is not really ideal to play with DNS or static IPs. I have kept the implementation simple, I’ve created a script that updates the /etc/issue file with runtime URL. (The script I use is <a href="http://svn.ottleys.net/public/alfresco/appliance/update-issue" target="_blank">here</a>.) The major issue I faced was when the script was to be run. I placed the script in /etc/network/if-up.d. I fully expected it to be run when the interface came up. The script did run when I manually ran ifup. But it didn’t run in every case, especially the most import, at boot time. I tried several different things to work through this. I added a reference to the script into /etc/network/interfaces using the post-up directive. (in openSUSE, you would add a POST_UP_SCRIPT=”<name of="" your="" script="">&#8221; to the interface file in /etc/sysconfig/network and put the script in /etc/sysconfig/network/scripts). This added a bit more power, but did quite fix my problem. I finally narrowed it down to <a href="http://en.wikipedia.org/wiki/Udev" target="_blank">udev</a>. The interface was being brought up by udev, but when /etc/init.d/networking is run, it runs ifup with a -a option (all interfaces marked auto). The problem with this is if the interface is already up, the associated scripts won&#8217;t be run. I haven&#8217;t found an appropriate fix for this yet. (Any ideas?) So I just disabled the udev rule for the network interfaces . <a href="http://www.rpath.com" target="_blank">rPath</a> has a good solution for this, they change /etc/issue file in an init script. I like this idea, but didn&#8217;t want to write another init script or pollute my existing alfresco init script with this.</name></p>

<p><strong>Plans for the Future</strong></p>

<p>One of the things that I want to do is provide some Alfresco branding to the appliance. I also want to create some more production ready appliances that use MySQL and point at an external virtual drive to store content and the indexes.</p>

<p><strong>What is Missing</strong></p>

<p>One of the big things that is missing in a management interface for the appliance. rPath provides a very nice extensible <a href="http://wiki.rpath.com/wiki/rPath_Appliance_Platform_Agent" target="_blank">web-based administrative interface</a>. It is extensible both for <a href="http://wiki.rpath.com/wiki/rPath_Appliance_Platform_Agent:Plugins" target="_blank">function</a> and <a href="http://wiki.rpath.com/wiki/rPath_Appliance_Platform_Agent:Branding" target="_blank">branding</a>. But it is rPath specific. I’d like to see an open source cross distro solution. One that was not only extensible but adds <a href="http://en.wikipedia.org/wiki/Common_Information_Model_%28computing%29" target="_blank">CIM based management</a> features. This would make it easy to administer the CIM instrumented applications on the appliance, but also could allow it to be managed externally, but CIM enabled management tools. This would allow the appliance to play nicely in the data center. This is <a href="http://wiki.xensource.com/xenwiki/XenCim" target="_blank">something</a> that Xen is working toward.</p>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="http://jared.ottleys.net/images/photo.JPG" class="bio-photo" alt="Jared Ottley bio photo"></a>
<h3>Jared Ottley</h3>
<p>Jared Ottley is an engineer at <a href='http://www.alfresco.com'>Alfresco</a>.  As the father of 6 he is raising a geek army. He has a degree in Political Science and drives a Mini.</p>
<a href="mailto:jared@ottleys.net" class="author-social"><i class="icon-mail"></i> jared@ottleys.net</a>
<a href="http://twitter.com/jottley" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>
<a href="http://facebook.com/jottley" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>
<a href="https://plus.google.com/u/0/116380333940951424604/posts" class="author-social" target="_blank"><i class="icon-google-plus"></i> Google+</a>
<a href="http://linkedin.com/in/jottley" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>
<a href="http://instagram.com/jaredtottley" class="author-social" target="_blank"><i class="icon-instagram"></i> Instagram</a>
<a href="http://github.com/jottley" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>
<a href="http://lastfm.com/jottley" class="author-social" target="_blank"><i class="icon-lastfm"></i> Last.fm</a>
<a href="http://www.flickr.com/photos/jottley" class="author-social" target="_blank"><i class="icon-flickr"></i> Flickr</a>

        </div>
        <p class="byline"><strong>Lessons learned in Appliance building, Ideas for the Future</strong> was published on <time datetime="2008-04-11T00:00:00-06:00" itemprop="datePublished">April 11, 2008</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="http://jared.ottleys.net/about" title="About Jared Ottley" itemprop="url">Jared Ottley</a></span></span>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://jared.ottleys.net/articles">View all articles</a>)</small></h4>
    <ul>
    
      
      
        
          
        
      
      
      <li><a href="http://jared.ottleys.net/alfresco/alfresco-property-decorators-cont" title="Alfresco: Property Decorators &#8212; cont.">Alfresco: Property Decorators &#8212; cont.</a></li>
      
    
      
      
        
          
        
      
      
      <li><a href="http://jared.ottleys.net/alfresco/alfresco-simple-workflow-web-scripts" title="Alfresco: Simple Workflow Web Scripts">Alfresco: Simple Workflow Web Scripts</a></li>
      
    
      
      
        
          
        
      
      
      <li><a href="http://jared.ottleys.net/alfresco/alfresco-simple-workflow" title="Alfresco: Simple Workflow">Alfresco: Simple Workflow</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2014 Jared Ottley. The thoughts here are my own and are not my employers...so blame me.</span>
  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://jared.ottleys.net/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://jared.ottleys.net/assets/js/scripts.min.js"></script>
<script src="http://jared.ottleys.net/assets/js/main.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-73397-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
	        

</body>
</html>
